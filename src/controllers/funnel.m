function [u, dw] = funnel(t, x, mu, k, b, psi, phi)%FUNNEL Funnel control implementation (Khalil 2017)%   -  mu: scaling parameter%   -   k: [1 k2 k3 ... kn]%   -   b: b(x), nonlinear control gain%   - psi: vector with yd(t) and its derivatives%   - phi: performance function    x = x(:);    n = size(x, 1);    M = (mu.^(0:n-1))';        sigma = M.*(x - psi(t)); % scaled parameters    s = k*sigma; % virtual output        v = -phi(t)*s/(1- phi(t)*abs(s)); % auxiliary control    u = (k(1:end-1)*sigma(2:end) + mu*v)/(mu^n*k(end)*b(x));    dw = [];end